var Feed=function(){"use strict";var e=!1,t=function t(){var n,i=Array.prototype.slice.call(arguments);i[0]="feed.fm: "+i[0],e&&console.log.apply(console,i);try{n=JSON.stringify({ts:new Date,message:i[0],args:i.slice(1)})}catch(e){n=JSON.stringify({ts:new Date,message:i[0],args:"truncated"})}t.history.push(n),t.history.length>500&&t.history.shift()};function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,n,i,o,a,s){try{var r=e[a](s),u=r.value}catch(e){return void n(e)}r.done?t(u):Promise.resolve(u).then(i,o)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,a=void 0;try{for(var s,r=e[Symbol.iterator]();!(i=(s=r.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(o)throw a}}return n}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=u(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){r=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw a}}}}t.history=[],t.enable=function(){e=!0},t.reset=function(){var e=t.history;return t.history=[],e};var c=0;function p(e){return e+ ++c}var h=Array.prototype.indexOf;function f(e,t,n,i){"function"==typeof t&&(i=n,n=t,t=!1);var o=n?e.map(n,i):e,a=[],s=[];return o.forEach((function(n,i){var o,r;(t?i&&s[s.length-1]===n:(r=n,null!==(o=s)&&(h&&o.indexOf===h?-1!=o.indexOf(r):o.some((function(e){return e===r})))))||(s.push(n),a.push(e[i]))})),a}function _(e,t){var n=t.map((function(e){return new RegExp(e)}));return f(e).filter((function(e){return n.find((function(t){return t.test(e)}))}))}function g(e,t,n){(e=e?2*e:200)>t&&(e=t),setTimeout((function(){n(e)}),e)}for(var y=Array.prototype.slice,v={on:function(e,t,n){return b(this,"on",e,[t,n])&&t?(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:n,ctx:n||this}),this):this},once:function(e,t,n){if(!b(this,"once",e,[t,n])||!t)return this;var i,o,a,s=this,r=(i=function(){s.off(e,r),t.apply(this,arguments)},a=!1,function(){return a||(a=!0,o=i.apply(this,arguments),i=null),o});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var i,o,a,s,r,u,d,l;if(!this._events||!b(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;for(r=0,u=(s=e?[e]:Object.keys(this._events)).length;r<u;r++)if(e=s[r],a=this._events[e]){if(this._events[e]=i=[],t||n)for(d=0,l=a.length;d<l;d++)o=a[d],(t&&t!==o.callback&&t!==o.callback._callback||n&&n!==o.context)&&i.push(o);i.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=y.call(arguments,1);if(!b(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&A(n,t),i&&A(i,arguments),this},stopListening:function(e,t,i){var o=this._listeners;if(!o)return this;var a=!t&&!i;for(var s in"object"===n(t)&&(i=this),e&&((o={})[e._listenerId]=e),o)o[s].off(t,i,this),a&&delete this._listeners[s];return this}},m=/\s+/,b=function(e,t,i,o){if(!i)return!0;if("object"===n(i)){for(var a in i)e[t].apply(e,[a,i[a]].concat(o));return!1}if(m.test(i)){for(var s=i.split(m),r=0,u=s.length;r<u;r++)e[t].apply(e,[s[r]].concat(o));return!1}return!0},A=function(e,t){var n,i=-1,o=e.length,a=t[0],s=t[1],r=t[2];switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,s);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,s,r);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t)}},S={listenTo:"on",listenToOnce:"once"},P=function(){var e=w[k],t=S[e];v[e]=function(e,i,o){return(this._listeners||(this._listeners={}))[e._listenerId||(e._listenerId=p("l"))]=e,"object"===n(i)&&(o=this),e[t](i,o,this),this}},k=0,w=Object.keys(S);k<w.length;k++)P();var T=/(iPhone|iPad)/i.test(navigator.userAgent),x=T&&/OS 13_[543210]/i.test(navigator.userAgent),I=T?"https://u9e9h7z5.map2.ssl.hwcdn.net/feedfm-audio/250-milliseconds-of-silence.mp3":"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",O=function(e,t,n,i){var o=Object.assign(this,v);if(o.id=n,o.url=i,o.speaker=e,o.loaded=!1,t){this.startPosition=+t.startPosition,this.endPosition=+t.endPosition,this.fadeInSeconds=+t.fadeInSeconds,this.fadeInSeconds?(this.fadeInStart=this.startPosition?this.startPosition/1e3:0,this.fadeInEnd=this.fadeInStart+this.fadeInSeconds):(this.fadeInStart=0,this.fadeInEnd=0),this.fadeOutSeconds=+t.fadeOutSeconds,this.fadeOutSeconds&&(this.endPosition?(this.fadeOutStart=this.endPosition/1e3-this.fadeOutSeconds,this.fadeOutEnd=this.endPosition/1e3):(this.fadeOutStart=0,this.fadeOutEnd=0));for(var a=0,s=["play","pause","finish","elapse"];a<s.length;a++){var r=s[a];r in t&&o.on(r,t[r])}this.gain=t.gain||0}else this.gain=0;return o};function E(e){return" src = "+e.src+", time = "+e.currentTime+", paused = "+e.paused+", duration = "+e.duration+", readyState = "+e.readyState}O.prototype={play:function(){return t("sound "+this.id+" play"),this.speaker._playSound(this)},pause:function(){return t("sound "+this.id+" pause"),this.speaker._pauseSound(this)},resume:function(){return t("sound "+this.id+" resume"),this.speaker._playSound(this)},position:function(){return this.speaker._position(this)},duration:function(){return this.speaker._duration(this)},destroy:function(){t("sound "+this.id+" destroy"),this.speaker._destroySound(this)},gainAdjustedVolume:function(e){if(!this.gain)return e/100;var t=Math.max(Math.min(e/100*(50*Math.pow(10,this.gain/20)),100),0)/100;return console.log("gain adjustment is "+this.gain+", and final adjusted volume is "+t),t}};var C=function(){};C.iOSp=T,C.brokenWebkit=x,C.prototype={vol:100,outstandingSounds:{},audioContext:null,active:null,fading:null,preparing:null,prepareWhenReady:null,initializeAudio:function(){null===this.active?(t("initializing for mobile"),this.audioContext=function(){var e=window.AudioContext||window.webkitAudioContext,t=new e;if(44100!==t.sampleRate){var n=t.createBuffer(1,1,44100),i=t.createBufferSource();i.buffer=n,i.connect(t.destination),i.start(0),i.disconnect(),t.close(),t=new e}return t}(),this.active=this._createAudio(I),this.fading=this._createAudio(I),this.preparing=this._createAudio(this.prepareWhenReady?this.prepareWhenReady:I),this.prepareWhenReady=null):t("mobile already initialized")},getSupportedFormats:function(){return"mp3"},_createAudioGainNode:function(e){var t=this.audioContext.createMediaElementSource(e),n=this.audioContext.createGain();return n.gain.value=1,t.connect(n),n.connect(this.audioContext.destination),n.gain},_createAudio:function(e){var t=new Audio(e);t.crossOrigin="anonymous",t.loop=!1,t.volume=1,this._addEventListeners(t);var n=null;return T&&!x&&(n=this._createAudioGainNode(t)),{audio:t,sound:null,gain:n,volume:1}},_addEventListeners:function(e){e.addEventListener("pause",this._onAudioPauseEvent.bind(this)),e.addEventListener("ended",this._onAudioEndedEvent.bind(this)),e.addEventListener("timeupdate",this._onAudioTimeUpdateEvent.bind(this))},_onAudioPauseEvent:function(e){var n=e.currentTarget;n.src!==I&&n===this.active.audio&&n.currentTime!==n.duration&&(this.active.sound&&this.active.sound.url===n.src?this.active.sound.trigger("pause"):t("active audio pause, but no matching sound"))},_onAudioEndedEvent:function(e){var n=e.currentTarget;if(n.src!==I){if(n===this.fading.audio)return n.src=I,void(this.fading.sound=null);if(n===this.active.audio)if(this.active.sound&&this.active.sound.url===n.src){t("active audio ended");var i=this.active.sound;this.active.sound=null,i.trigger("finish")}else t("active audio ended, but no matching sound",n.src)}},_onAudioTimeUpdateEvent:function(e){var n=e.currentTarget;if(n.src!==I)if(n===this.fading.audio&&this.fading.sound)this.fading.sound.endPosition&&n.currentTime>=this.fading.sound.endPosition/1e3?(this.fading.sound=null,this.fading.audio.src=I):this._setVolume(this.fading);else if(n===this.active.audio&&this.active.sound)if(this.active.sound.url===n.src){if(this.active.sound.endPosition&&this.active.sound.endPosition/1e3<=n.currentTime){var i=this.active.sound;this.active.sound=null,this.active.audio.src=I,i.trigger("finish")}else if(this.active.sound.fadeOutEnd&&n.currentTime>=this.active.sound.fadeOutStart){this._setVolume(this.active);var o=this.fading;this.fading=this.active,this.active=o,this.active.sound=null,this.fading.sound.trigger("finish")}else this._setVolume(this.active),this.active.sound.trigger("elapse");this.prepareWhenReady&&this.prepare(this.prepareWhenReady)}else t("active audio elapsed, but no matching sound, so ignoring",n.src)},_setVolume:function(e,n){n||(n=e.sound);var i=e.audio.currentTime,o=e.audio.volume(),a=n.gainAdjustedVolume(this.vol);n.fadeInStart!==n.fadeInEnd&&i<n.fadeInStart?(a=0,t("pre-fade-in volume is 0")):n.fadeInStart!==n.fadeInEnd&&i>=n.fadeInStart&&i<=n.fadeInEnd?(a=(i-n.fadeInStart)/(n.fadeInEnd-n.fadeInStart)*a,t("ramping \u25b2 volume",{currentTime:i,currentVolume:o,calculatedVolume:a,sound:n})):n.fadeOutStart!==n.fadeOutEnd&&i>n.fadeOutEnd?(a=0,t("post-fade-out volume is 0")):n.fadeOutStart!==n.fadeOutEnd&&i>=n.fadeOutStart&&i<=n.fadeOutEnd&&(a=(1-(i-n.fadeOutStart)/(n.fadeOutEnd-n.fadeOutStart))*a,t("ramping \u25bc volume",{currentTime:i,currentVolume:o,calculatedVolume:a,sound:n})),o!==a&&e.audio.volume(a)},_debugAudioObject:function(e){for(var n=["abort","load","loadend","loadstart","loadeddata","loadedmetadata","canplay","canplaythrough","seeked","seeking","stalled","timeupdate","volumechange","waiting","durationchange","progress","emptied","ended","play","pause"],i=this,o=0;o<n.length;o++)e.addEventListener(n[o],(function(e){var n=e.currentTarget,o=n===i.active.audio?"active":n===i.preparing.audio?"preparing":"fading";t(o+": "+e.type),t("    active: "+E(i.active.audio)),t("    preparing: "+E(i.preparing.audio)),t("    fading: "+E(i.fading.audio)),n.src}))},create:function(e,n){var i=p("feed-play-"),o=new O(this,n,i,e);return t("created play "+i+" ("+e+")",n),this.outstandingSounds[o.id]=o,this.active&&this.active.audio?this.preparing.audio.src===I&&(t("preparing sound now"),this._prepare(o.url,o.startPosition)):(t("no audio prepared yet, so preparing when ready"),this.prepareWhenReady=o.url),o},prepare:function(e){if(!this.active||!this.active.audio)return t("saving url to prepare for later",e),void(this.prepareWhenReady=e);var n=this.active.audio.buffered;return n.length>0&&n.end(n.length-1)>=this.active.audio.duration?(t("active song has loaded enough, to preparing",e),this._prepare(e,0)):this.active.audio.url===I?(t("preparing over silence"),this._prepare(e,0)):(t("nothing available to do active prepare"),void(this.prepareWhenReady=e))},logState:function(e){for(var t in console.group("speaker: "+(e||"")),this.active?(console.group("active"),console.log("audio.src: ".concat(this.active.audio.src)),console.log("audio.paused: ".concat(this.active.audio.paused)),console.log("sound: ".concat(this.active.sound?this.active.sound.id:"NULL")),console.log("volume: ".concat(this.active.volume)),console.groupEnd(),console.group("preparing"),console.log("audio.src: ".concat(this.preparing.audio.src)),console.log("audio.paused: ".concat(this.preparing.audio.paused)),console.log("sound: ".concat(this.preparing.sound?this.preparing.sound.id:"NULL")),console.log("volume: ".concat(this.preparing.volume)),console.groupEnd(),console.group("fading"),console.log("audio.src: ".concat(this.fading.audio.src)),console.log("audio.paused: ".concat(this.fading.audio.paused)),console.log("sound: ".concat(this.fading.sound?this.fading.sound.id:"NULL")),console.log("volume: ".concat(this.fading.volume)),console.groupEnd()):(console.group("active"),console.log("uninitialized"),console.groupEnd(),console.group("preparing"),console.log("uninitialized"),console.groupEnd(),console.group("fading"),console.log("uninitialized"),console.groupEnd()),console.group("outstanding sounds"),this.outstandingSounds){var n=this.outstandingSounds[t];console.log(n.id+": "+n.url)}console.groupEnd(),console.groupEnd()},_prepare:function(e,n){this.prepareWhenReady=null,this.preparing.audio.src!==e&&(t("preparing "+e),this.preparing.audio.src=e),n&&this.preparing.audio.currentTime!==n&&(t("advancing preparing audio to",n/1e3),this.preparing.audio.currentTime=n/1e3)},_playSound:function(e){var n=this;if(this.active&&this.active.audio)if(this.active.sound===e)this.active.audio.paused?(t(e.id+" was paused, so resuming"),this.active.audio.play().then((function(){t("resumed playback"),e.trigger("play")})).catch((function(){t("error resuming playback"),n.active.sound=null,e.trigger("finish")})),this.fading.sound&&this.fading.audio.play().then((function(){t("resumed fading playback")})).catch((function(){t("error resuming fading playback"),n.fading.sound=null,n.fading.audio.src=I}))):t(e.id+" is already playing");else{this.preparing.audio.src!==e.url&&this._prepare(e.url,e.startPosition);var i=this.active;if(this.active=this.preparing,this.preparing=i,this.active.sound=null,this._setVolume(this.active,e),this.preparing.sound){this.preparing.audio.src=I;var o=this.preparing.sound;this.preparing.sound=null,o.trigger("finish")}t(e.id+" initiating play()");var a=this.active;this.active.audio.play().then((function(){if(!n.outstandingSounds[e.id])return t(e.id+" play() succeeded, but sound has been destroyed"),void(a.audio&&a.audio.src===e.url&&(t(e.id+" being paused and unloaded"),a.audio.pause(),a.audio.src=I));t(e.id+" play() succeeded"),a.sound=e,e.fadeOutSeconds&&0===e.fadeOutEnd&&(e.fadeOutStart=a.audio.duration-e.fadeOutSeconds,e.fadeOutEnd=a.audio.duration),e.startPosition&&(t("updating start position"),a.audio.currentTime=e.startPosition/1e3,t("updated"));var i=a.audio.paused;e.trigger("play"),a.pauseAfterPlay?a.audio.pause():i&&e.trigger("pause")})).catch((function(n){t("error starting playback with sound "+e.id,n),e.trigger("finish",n)}))}else console.error("**** player.initializeAudio() *** not called before playback!")},_destroySound:function(e){e.off(),this.active&&this.active.sound===e?(t("destroy triggered for current sound",e.id),this.active.audio.pause()):t("destroy triggered for inactive sound",e.id),delete this.outstandingSounds[e.id]},flush:function(){for(var e in this.outstandingSounds)this.outstandingSounds[e].destroy()},_pauseSound:function(e){this.active&&e.url===this.active.audio.src&&(this.active.sound===e?this.active.audio.pause():this.active.pauseAfterPlay=!0),this.fading&&this.fading.audio&&this.fading.audio.pause()},_position:function(e){return this.active&&e===this.active.sound?(e.url!==this.active.audio.src&&t("trying to get current song position, but it is not in the active audio player"),Math.floor(1e3*this.active.audio.currentTime)):0},_duration:function(e){if(e===this.active.sound){e.url!==this.active.audio.src&&t("trying to get current song duration, but it is not in the active audio player");var n=this.active.audio.duration;return isNaN(n)?0:Math.floor(1e3*n)}return 0},setVolume:function(e){return void 0!==e&&(this.vol=e,this.active&&this.active.sound&&this._setVolume(this.active),this.trigger("volume",e)),this.vol},getVolume:function(){return this.vol}},Object.assign(C.prototype,v);var L="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var B,M=(function(e,t){
/*!
   *  howler.js v2.2.1
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   */
!function(){var e=function(){this.init()};e.prototype={init:function(){var e=this||n;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||l(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var o=t._howls[i]._getSoundIds(),a=0;a<o.length;a++){var s=t._howls[i]._soundById(o[a]);s&&s._node&&(s._node.volume=s._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||l(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var o=t._howls[i]._getSoundIds(),a=0;a<o.length;a++){var s=t._howls[i]._soundById(o[a]);s&&s._node&&(s._node.muted=!!e||s._muted)}return t},stop:function(){for(var e=this||n,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,l()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||n;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),a=o&&parseInt(o[0].split("/")[1],10)<33;return e._codecs={mp3:!(a||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||n;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch(n){e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var a=e._howls[o]._getSoundIds(),s=0;s<a.length;s++){var r=e._howls[o]._soundById(a[s]);r&&r._node&&!r._node._unlocked&&(r._node._unlocked=!0,r._node.load())}e._autoResume();var u=e.ctx.createBufferSource();u.buffer=e._scratchBuffer,u.connect(e.ctx.destination),void 0===u.start?u.noteOn(0):u.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),u.onended=function(){u.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||n;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||n;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&n.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&n.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var n=new e,i=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init:function(e){var t=this;return n.ctx||l(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,void 0!==n.ctx&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=null;if(n.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var i,a;if(this._format&&this._format[t])i=this._format[t];else{if("string"!=typeof(a=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(a))||(i=/\.([^.]+)$/.exec(a.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&n.codecs(i)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new o(this),this._webAudio&&s(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,o=null;if("number"==typeof e)o=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var a=0,s=0;s<i._sounds.length;s++)i._sounds[s]._paused&&!i._sounds[s]._ended&&(a++,o=i._sounds[s]._id);1===a?e=null:o=null}}var r=o?i._soundById(o):i._inactiveSound();if(!r)return null;if(o&&!e&&(e=r._sprite||"__default"),"loaded"!==i._state){r._sprite=e,r._ended=!1;var u=r._id;return i._queue.push({event:"play",action:function(){i.play(u)}}),u}if(o&&!r._paused)return t||i._loadQueue("play"),r._id;i._webAudio&&n._autoResume();var d=Math.max(0,r._seek>0?r._seek:i._sprite[e][0]/1e3),l=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-d),c=1e3*l/Math.abs(r._rate),p=i._sprite[e][0]/1e3,h=(i._sprite[e][0]+i._sprite[e][1])/1e3;r._sprite=e,r._ended=!1;var f=function(){r._paused=!1,r._seek=d,r._start=p,r._stop=h,r._loop=!(!r._loop&&!i._sprite[e][2])};if(!(d>=h)){var _=r._node;if(i._webAudio){var g=function(){i._playLock=!1,f(),i._refreshBuffer(r);var e=r._muted||i._muted?0:r._volume;_.gain.setValueAtTime(e,n.ctx.currentTime),r._playStart=n.ctx.currentTime,void 0===_.bufferSource.start?r._loop?_.bufferSource.noteGrainOn(0,d,86400):_.bufferSource.noteGrainOn(0,d,l):r._loop?_.bufferSource.start(0,d,86400):_.bufferSource.start(0,d,l),c!==1/0&&(i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),c)),t||setTimeout((function(){i._emit("play",r._id),i._loadQueue()}),0)};"running"===n.state&&"interrupted"!==n.ctx.state?g():(i._playLock=!0,i.once("resume",g),i._clearTimer(r._id))}else{var y=function(){_.currentTime=d,_.muted=r._muted||i._muted||n._muted||_.muted,_.volume=r._volume*n.volume(),_.playbackRate=r._rate;try{var o=_.play();if(o&&"undefined"!=typeof Promise&&(o instanceof Promise||"function"==typeof o.then)?(i._playLock=!0,f(),o.then((function(){i._playLock=!1,_._unlocked=!0,t||(i._emit("play",r._id),i._loadQueue())})).catch((function(){i._playLock=!1,i._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),r._ended=!0,r._paused=!0}))):t||(i._playLock=!1,f(),i._emit("play",r._id),i._loadQueue()),_.playbackRate=r._rate,_.paused)return void i._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||r._loop?i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),c):(i._endTimers[r._id]=function(){i._ended(r),_.removeEventListener("ended",i._endTimers[r._id],!1)},_.addEventListener("ended",i._endTimers[r._id],!1))}catch(e){i._emit("playerror",r._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===_.src&&(_.src=i._src,_.load());var v=window&&window.ejecta||!_.readyState&&n._navigator.isCocoonJS;if(_.readyState>=3||v)y();else{i._playLock=!0;var m=function(){y(),_.removeEventListener(n._canPlayEvent,m,!1)};_.addEventListener(n._canPlayEvent,m,!1),i._clearTimer(r._id)}}return r._id}i._ended(r)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused&&(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else isNaN(o._node.duration)&&o._node.duration!==1/0||o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var a=n._soundById(i[o]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,n._stopFade(i[o]),a._node&&(n._webAudio?a._node.bufferSource&&(void 0===a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),n._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&n._clearSound(a._node))),t||n._emit("stop",a._id))}return n},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var o=i._getSoundIds(t),a=0;a<o.length;a++){var s=i._soundById(o[a]);s&&(s._muted=e,s._interval&&i._stopFade(s._id),i._webAudio&&s._node?s._node.gain.setValueAtTime(e?0:s._volume,n.ctx.currentTime):s._node&&(s._node.muted=!!n._muted||e),i._emit("mute",s._id))}return i},volume:function(){var e,t,i,o=this,a=arguments;if(0===a.length)return o._volume;if(1===a.length||2===a.length&&void 0===a[1]){var s=o._getSoundIds(),r=s.indexOf(a[0]);r>=0?t=parseInt(a[0],10):e=parseFloat(a[0])}else a.length>=2&&(e=parseFloat(a[0]),t=parseInt(a[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(i=t?o._soundById(t):o._sounds[0])?i._volume:0;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"volume",action:function(){o.volume.apply(o,a)}}),o;void 0===t&&(o._volume=e),t=o._getSoundIds(t);for(var u=0;u<t.length;u++)(i=o._soundById(t[u]))&&(i._volume=e,a[2]||o._stopFade(t[u]),o._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,n.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*n.volume()),o._emit("volume",i._id));return o},fade:function(e,t,i,o){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"fade",action:function(){a.fade(e,t,i,o)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),a.volume(e,o);for(var s=a._getSoundIds(o),r=0;r<s.length;r++){var u=a._soundById(s[r]);if(u){if(o||a._stopFade(s[r]),a._webAudio&&!u._muted){var d=n.ctx.currentTime,l=d+i/1e3;u._volume=e,u._node.gain.setValueAtTime(e,d),u._node.gain.linearRampToValueAtTime(t,l)}a._startFadeInterval(u,e,t,i,s[r],void 0===o)}}return a},_startFadeInterval:function(e,t,n,i,o,a){var s=this,r=t,u=n-t,d=Math.abs(u/.01),l=Math.max(4,d>0?i/d:i),c=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var o=(Date.now()-c)/i;c=Date.now(),r+=u*o,r=Math.round(100*r)/100,r=u<0?Math.max(n,r):Math.min(n,r),s._webAudio?e._volume=r:s.volume(r,e._id,!0),a&&(s._volume=r),(n<t&&r<=n||n>t&&r>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(n,e._id),s._emit("fade",e._id))}),l)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,n,i=this,o=arguments;if(0===o.length)return i._loop;if(1===o.length){if("boolean"!=typeof o[0])return!!(n=i._soundById(parseInt(o[0],10)))&&n._loop;e=o[0],i._loop=e}else 2===o.length&&(e=o[0],t=parseInt(o[1],10));for(var a=i._getSoundIds(t),s=0;s<a.length;s++)(n=i._soundById(a[s]))&&(n._loop=e,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop)));return i},rate:function(){var e,t,i,o=this,a=arguments;if(0===a.length)t=o._sounds[0]._id;else if(1===a.length){var s=o._getSoundIds(),r=s.indexOf(a[0]);r>=0?t=parseInt(a[0],10):e=parseFloat(a[0])}else 2===a.length&&(e=parseFloat(a[0]),t=parseInt(a[1],10));if("number"!=typeof e)return(i=o._soundById(t))?i._rate:o._rate;if("loaded"!==o._state||o._playLock)return o._queue.push({event:"rate",action:function(){o.rate.apply(o,a)}}),o;void 0===t&&(o._rate=e),t=o._getSoundIds(t);for(var u=0;u<t.length;u++)if(i=o._soundById(t[u])){o.playing(t[u])&&(i._rateSeek=o.seek(t[u]),i._playStart=o._webAudio?n.ctx.currentTime:i._playStart),i._rate=e,o._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,n.ctx.currentTime):i._node&&(i._node.playbackRate=e);var d=o.seek(t[u]),l=(o._sprite[i._sprite][0]+o._sprite[i._sprite][1])/1e3-d,c=1e3*l/Math.abs(i._rate);!o._endTimers[t[u]]&&i._paused||(o._clearTimer(t[u]),o._endTimers[t[u]]=setTimeout(o._ended.bind(o,i),c)),o._emit("rate",i._id)}return o},seek:function(){var e,t,i=this,o=arguments;if(0===o.length)t=i._sounds[0]._id;else if(1===o.length){var a=i._getSoundIds(),s=a.indexOf(o[0]);s>=0?t=parseInt(o[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(o[0]))}else 2===o.length&&(e=parseFloat(o[0]),t=parseInt(o[1],10));if(void 0===t)return i;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var r=i._soundById(t);if(r){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var u=i.playing(t)?n.ctx.currentTime-r._playStart:0,d=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(d+u*Math.abs(r._rate))}return r._node.currentTime}var l=i.playing(t);l&&i.pause(t,!0),r._seek=e,r._ended=!1,i._clearTimer(t),i._webAudio||!r._node||isNaN(r._node.duration)||(r._node.currentTime=e);var c=function(){i._emit("seek",t),l&&i.play(t,!0)};if(l&&!i._webAudio){var p=function(){i._playLock?setTimeout(p,0):c()};setTimeout(p,0)}else c()}return i},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var n=0;n<this._sounds.length;n++)if(!this._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this._duration,n=this._soundById(e);return n&&(t=this._sprite[n._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(n._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),n._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var o=n._howls.indexOf(e);o>=0&&n._howls.splice(o,1);var s=!0;for(i=0;i<n._howls.length;i++)if(n._howls[i]._src===e._src||e._src.indexOf(n._howls[i]._src)>=0){s=!1;break}return a&&s&&delete a[e._src],n.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this["_on"+e];return"function"==typeof t&&o.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),this},off:function(e,t,n){var i=this["_on"+e],o=0;if("number"==typeof t&&(n=t,t=null),t||n)for(o=0;o<i.length;o++){var a=n===i[o].id;if(t===i[o].fn&&a||!t&&a){i.splice(o,1);break}}else if(e)this["_on"+e]=[];else{var s=Object.keys(this);for(o=0;o<s.length;o++)0===s[o].indexOf("_on")&&Array.isArray(this[s[o]])&&(this[s[o]]=[])}return this},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var i=this["_on"+e],o=i.length-1;o>=0;o--)i[o].id&&i[o].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(this,i[o].fn),0),i[o].once&&this.off(e,i[o].fn,i[o].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var i=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&i&&this.stop(e._id,!0).play(e._id),this._webAudio&&i){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var o=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),o)}return this._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),n._autoSuspend()),this._webAudio||i||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new o(this)},_drain:function(){var e=this._pool,t=0,n=0;if(!(this._sounds.length<e)){for(n=0;n<this._sounds.length;n++)this._sounds[n]._ended&&t++;for(n=this._sounds.length-1;n>=0;n--){if(t<=e)return;this._sounds[n]._ended&&(this._webAudio&&this._sounds[n]._node&&this._sounds[n]._node.disconnect(0),this._sounds.splice(n,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=a[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),this},_cleanBuffer:function(e){var t=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=n._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++n._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=n._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),this._node.gain.setValueAtTime(t,n.ctx.currentTime),this._node.paused=!0,this._node.connect(n.masterGain)):n.noAudio||(this._node=n._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(n._canPlayEvent,this._loadFn,!1),this._endFn=this._endListener.bind(this),this._node.addEventListener("ended",this._endFn,!1),this._node.src=e._src,this._node.preload=!0===e._preload?"auto":e._preload,this._node.volume=t*n.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++n._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(n._canPlayEvent,this._loadFn,!1)},_endListener:function(){var e=this._parent;e._duration===1/0&&(e._duration=Math.ceil(10*this._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(this)),this._node.removeEventListener("ended",this._endFn,!1)}};var a={},s=function(e){var t=e._src;if(a[t])return e._duration=a[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);u(i.buffer,e)}else{var s=new XMLHttpRequest;s.open(e._xhr.method,t,!0),s.withCredentials=e._xhr.withCredentials,s.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){s.setRequestHeader(t,e._xhr.headers[t])})),s.onload=function(){var t=(s.status+"")[0];"0"===t||"2"===t||"3"===t?u(s.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+s.status+".")},s.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete a[t],e.load())},r(s)}},r=function(e){try{e.send()}catch(t){e.onerror()}},u=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},o=function(e){e&&t._sounds.length>0?(a[t._src]=e,d(t,e)):i()};"undefined"!=typeof Promise&&1===n.ctx.decodeAudioData.length?n.ctx.decodeAudioData(e).then(o).catch(i):n.ctx.decodeAudioData(e,o,i)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},l=function(){if(n.usingWebAudio){try{"undefined"!=typeof AudioContext?n.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch(e){n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var o=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!o&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=void 0===n.ctx.createGain?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};t.Howler=n,t.Howl=i,void 0!==L?(L.HowlerGlobal=e,L.Howler=n,L.Howl=i,L.Sound=o):"undefined"!=typeof window&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=o)}(),
/*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.1
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,n){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,n="number"!=typeof n?this._pos[2]:n,"number"!=typeof e?this._pos:(this._pos=[e,t,n],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,n,i,o,a){if(!this.ctx||!this.ctx.listener)return this;var s=this._orientation;return t="number"!=typeof t?s[1]:t,n="number"!=typeof n?s[2]:n,i="number"!=typeof i?s[3]:i,o="number"!=typeof o?s[4]:o,a="number"!=typeof a?s[5]:a,"number"!=typeof e?s:(this._orientation=[e,t,n,i,o,a],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,n,i,o,a),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(e,n)}}),i;var o=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===n){if("number"!=typeof e)return i._stereo;i._stereo=e,i._pos=[e,0,0]}for(var a=i._getSoundIds(n),s=0;s<a.length;s++){var r=i._soundById(a[s]);if(r){if("number"!=typeof e)return r._stereo;r._stereo=e,r._pos=[e,0,0],r._node&&(r._pannerAttr.panningModel="equalpower",r._panner&&r._panner.pan||t(r,o),"spatial"===o?void 0!==r._panner.positionX?(r._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),r._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),r._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):r._panner.setPosition(e,0,0):r._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",r._id)}}return i},Howl.prototype.pos=function(e,n,i,o){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(e,n,i,o)}}),a;if(n="number"!=typeof n?0:n,i="number"!=typeof i?-.5:i,void 0===o){if("number"!=typeof e)return a._pos;a._pos=[e,n,i]}for(var s=a._getSoundIds(o),r=0;r<s.length;r++){var u=a._soundById(s[r]);if(u){if("number"!=typeof e)return u._pos;u._pos=[e,n,i],u._node&&(u._panner&&!u._panner.pan||t(u,"spatial"),void 0!==u._panner.positionX?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(e,n,i)),a._emit("pos",u._id)}}return a},Howl.prototype.orientation=function(e,n,i,o){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(e,n,i,o)}}),a;if(n="number"!=typeof n?a._orientation[1]:n,i="number"!=typeof i?a._orientation[2]:i,void 0===o){if("number"!=typeof e)return a._orientation;a._orientation=[e,n,i]}for(var s=a._getSoundIds(o),r=0;r<s.length;r++){var u=a._soundById(s[r]);if(u){if("number"!=typeof e)return u._orientation;u._orientation=[e,n,i],u._node&&(u._panner||(u._pos||(u._pos=a._pos||[0,0,-.5]),t(u,"spatial")),void 0!==u._panner.orientationX?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(e,n,i)),a._emit("orientation",u._id)}}return a},Howl.prototype.pannerAttr=function(){var e,n,i,o=this,a=arguments;if(!o._webAudio)return o;if(0===a.length)return o._pannerAttr;if(1===a.length){if("object"!=typeof a[0])return(i=o._soundById(parseInt(a[0],10)))?i._pannerAttr:o._pannerAttr;e=a[0],void 0===n&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),o._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:o._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:o._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:o._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:o._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:o._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:o._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:o._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:o._panningModel})}else 2===a.length&&(e=a[0],n=parseInt(a[1],10));for(var s=o._getSoundIds(n),r=0;r<s.length;r++)if(i=o._soundById(s[r])){var u=i._pannerAttr;u={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:u.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:u.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:u.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:u.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:u.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:u.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:u.panningModel};var d=i._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor,d.panningModel=u.panningModel):(i._pos||(i._pos=o._pos||[0,0,-.5]),t(i,"spatial"))}return o},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}(B={exports:{}},B.exports),B.exports),q=(M.Howler,M.Howl),R=function(e,t,n,i){var o=Object.assign(this,v);if(o.id=n,o.url=i,o.speaker=e,o.loaded=!1,t){this.startPosition=+t.startPosition,this.endPosition=+t.endPosition,this.fadeInSeconds=+t.fadeInSeconds,this.fadeInSeconds?(this.fadeInStart=this.startPosition?this.startPosition/1e3:0,this.fadeInEnd=this.fadeInStart+this.fadeInSeconds):(this.fadeInStart=0,this.fadeInEnd=0),this.fadeOutSeconds=+t.fadeOutSeconds,this.fadeOutSeconds&&(this.endPosition?(this.fadeOutStart=this.endPosition/1e3-this.fadeOutSeconds,this.fadeOutEnd=this.endPosition/1e3):(this.fadeOutStart=0,this.fadeOutEnd=0));for(var a=0,s=["play","pause","finish","elapse"];a<s.length;a++){var r=s[a];r in t&&o.on(r,t[r])}this.gain=t.gain||0}else this.gain=0;return o},j=/(iPhone|iPad)/i.test(navigator.userAgent),D=j&&/OS 13_[543210]/i.test(navigator.userAgent),F=j?"https://u9e9h7z5.map2.ssl.hwcdn.net/feedfm-audio/250-milliseconds-of-silence.mp3":"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA";function H(e){return" src = "+e.src+", time = "+e.currentTime+", paused = "+e.paused+", duration = "+e.duration+", readyState = "+e.readyState}R.prototype={play:function(){return t("sound "+this.id+" play"),this.speaker._playSound(this)},pause:function(){return console.log("sound "+this.id+" pause"),this.speaker._pauseSound(this)},resume:function(){return t("sound "+this.id+" resume"),this.speaker._playSound(this)},position:function(){return this.speaker._position(this)},duration:function(){return this.speaker._duration(this)},destroy:function(){t("sound "+this.id+" destroy"),this.speaker._destroySound(this)},gainAdjustedVolume:function(e){return this.gain?Math.max(Math.min(e/100*(50*Math.pow(10,this.gain/20)),100),0)/100:e/100}};var V,N=function(){};function G(){var e=window.AudioContext||window.webkitAudioContext,t=new e;if(44100!==t.sampleRate){var n=t.createBuffer(1,1,44100),i=t.createBufferSource();i.buffer=n,i.connect(t.destination),i.start(0),i.disconnect(),t.close(),t=new e}return t}N.iOSp=j,N.brokenWebkit=D,N.prototype={vol:100,outstandingSounds:{},audioContext:null,active:null,fading:null,preparing:null,prepareWhenReady:null,attachEventHandlers:function(e){var n=this;e.on("stop",(function(){if(e.src!==F){if(e===n.fading.audio)return e.src=F,void(n.fading.sound=null);if(e===n.active.audio)if(n.active.sound&&n.active.sound.url===e.src){t("active audio ended");var i=n.active.sound;n.active.sound=null,i.trigger("finish")}else t("active audio ended, but no matching sound",e.src)}})),e.on("pause",(function(){console.log(e,n.active.audio),e.src!==F&&e===n.active.audio&&e.currentTime!==e.duration&&(n.active.sound&&n.active.sound.url===e.src?n.active.sound.trigger("pause"):t("active audio pause, but no matching sound"))})),e.on("end",(function(){var e=n.active.sound;n.active.sound=null,n.active.url=F,e.trigger("finish")})),e.on("fade",(function(){if(n.active.sound.fadeOutEnd&&e.seek()>=n.active.sound.fadeOutStart){n._setVolume(n.active);var t=n.fading;n.fading=n.active,n.active=t,n.active.sound=null,n.fading.sound.trigger("finish")}})),e.on("seek",(function(){console.log("seeking"),e.url!==F&&e===n.active.audio&&n.active.sound&&(n.active.sound.trigger("elapse"),n.prepareWhenReady&&n.prepare(n.prepareWhenReady))}))},_createAudioPlayer:(V=function(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var s=e.apply(t,n);function r(e){i(s,o,a,r,u,"next",e)}function u(e){i(s,o,a,r,u,"throw",e)}r(void 0)}))}}(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){n.active.sound&&(n.active.sound.trigger("elapse"),n.prepareWhenReady&&n.prepare(n.prepareWhenReady),i.playing()&&requestAnimationFrame(o.bind(n)))},n=this,console.log("Settinng up Howl, ".concat(t)),i=new q({src:[t],loop:!1,volume:1,onplay:function(){console.log(this),requestAnimationFrame(o.bind(n))}}),this.attachEventHandlers(i,t),e.abrupt("return",{url:t,sound:null,volume:1,audio:i});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return V.apply(this,arguments)}),initializeAudio:function(){var e=this;if(console.log("Attempting to Initialize Audio"),null===this.active)return console.log("No active player, initializing"),this.audioContext=G(),Promise.all([this._createAudioPlayer(F),this._createAudioPlayer(F),this._createAudioPlayer(this.prepareWhenReady?this.prepareWhenReady:F)]).then((function(t){var n=r(t,3),i=n[0],o=n[1],a=n[2];e.active=i,console.log("active player initialized"),e.fading=o,console.log("fading player initialized"),e.preparing=a,console.log("preparing player initialized"),e.prepareWhenReady=null}))},getSupportedFormats:function(){return document.createElement("audio").canPlayType("audio/aac")?"aac,mp3":"mp3"},_setVolume:function(e,t){t||(t=e.sound);var n=e.audio.currentTime,i=e.audio.gain&&e.audio.gain.gain&&e.audio.gain.gain.value,o=t.gainAdjustedVolume(this.vol);t.fadeInStart!==t.fadeInEnd&&n<t.fadeInStart?(o=0,console.log("pre-fade-in volume is 0")):t.fadeInStart!==t.fadeInEnd&&n>=t.fadeInStart&&n<=t.fadeInEnd?(o=(n-t.fadeInStart)/(t.fadeInEnd-t.fadeInStart)*o,console.log("ramping \u25b2 volume",{currentTime:n,currentVolume:i,calculatedVolume:o,sound:t})):t.fadeOutStart!==t.fadeOutEnd&&n>t.fadeOutEnd?(o=0,console.log("post-fade-out volume is 0")):t.fadeOutStart!==t.fadeOutEnd&&n>=t.fadeOutStart&&n<=t.fadeOutEnd&&(o=(1-(n-t.fadeOutStart)/(t.fadeOutEnd-t.fadeOutStart))*o,console.log("ramping \u25bc volume",{currentTime:n,currentVolume:i,calculatedVolume:o,sound:t})),e.audio.volume(o)},_debugAudioObject:function(e){for(var n=["abort","load","loadend","loadstart","loadeddata","loadedmetadata","canplay","canplaythrough","seeked","seeking","stalled","timeupdate","volumechange","waiting","durationchange","progress","emptied","ended","play","pause"],i=this,o=0;o<n.length;o++)e.addEventListener(n[o],(function(e){var n=e.currentTarget,o=n===i.active.audio?"active":n===i.preparing.audio?"preparing":"fading";t(o+": "+e.type),t("    active: "+H(i.active.audio)),t("    preparing: "+H(i.preparing.audio)),t("    fading: "+H(i.fading.audio)),n.src}))},create:function(e,n){var i=p("feed-play-"),o=new R(this,n,i,e);return t("created play "+i+" ("+e+")",n),this.outstandingSounds[o.id]=o,this.active&&this.active.audio?this.preparing.audio.src===F&&(console.log("preparing sound now"),this._prepare(o.url,o.startPosition)):(console.log("no audio prepared yet, so preparing when ready"),this.prepareWhenReady=o.url),o},prepare:function(e){return this.active&&this.active.audio?(console.log(this.active.audio,"AUDIO"),console.log(this.active.audio.seek(),this.active.audio._duration,"AUDIO"),"loaded"===this.active.audio._state&&this.active.audio.seek()>20?(console.log("active song has loaded enough, to preparing",e),this._prepare(e,0)):this.active.url===F?(console.log("preparing over silence"),this._prepare(e,0)):(console.log("nothing available to do active prepare"),void(this.prepareWhenReady=e))):(console.log("saving url to prepare for later",e),void(this.prepareWhenReady=e))},logState:function(e){for(var t in console.group("speaker: "+(e||"")),this.active?(console.group("active"),console.log("audio.src: ".concat(this.active.url)),console.log("audio.paused: ".concat(!this.active.audio.playing())),console.log("sound: ".concat(this.active.sound?this.active.sound.id:"NULL")),console.log("volume: ".concat(this.active.volume)),console.groupEnd(),console.group("preparing"),console.log("audio.src: ".concat(this.preparing.audio.src)),console.log("audio.paused: ".concat(!this.preparing.audio.playing())),console.log("sound: ".concat(this.preparing.sound?this.preparing.sound.id:"NULL")),console.log("volume: ".concat(this.preparing.volume)),console.groupEnd(),console.group("fading"),console.log("audio.src: ".concat(this.fading.audio.src)),console.log("audio.paused: ".concat(!this.fading.audio.playing())),console.log("sound: ".concat(this.fading.sound?this.fading.sound.id:"NULL")),console.log("volume: ".concat(this.fading.volume)),console.groupEnd()):(console.group("active"),console.log("uninitialized"),console.groupEnd(),console.group("preparing"),console.log("uninitialized"),console.groupEnd(),console.group("fading"),console.log("uninitialized"),console.groupEnd()),console.group("outstanding sounds"),this.outstandingSounds){var n=this.outstandingSounds[t];console.log(n.id+": "+n.url)}console.groupEnd(),console.groupEnd()},_prepare:function(e,n){var i=this;if(this.prepareWhenReady=null,this.preparing.audio.src!==e)return console.log("preparing "+e),this.audioContext=G(),this._createAudioPlayer(e).then((function(e){i.preparing=e}));n&&this.preparing.audio.currentTime!==n&&(t("advancing preparing audio to",n/1e3),this.preparing.audio.currentTime=n/1e3)},_playSound:function(e){var n=this,i=this;if(console.log("Play sound"),this.active&&this.active.audio)if(this.active.sound===e)if(this.active.audio.playing())console.log(e.id+" is already playing");else{console.log(e.id+" was paused, so resuming");try{this.active.audio.play(),t("resumed playback"),e.trigger("play")}catch(n){t("error resuming playback",n),i.active.sound=null,e.trigger("finish")}if(this.fading.sound)try{this.fading.audio.play(),t("resumed fading playback")}catch(e){t("error resuming fading playback",e),i.fading.sound=null,i.fading.audio.src=F}}else{var o=function(){var o=n.active;if(n.active=n.preparing,n.preparing=o,n.active.sound=null,n._setVolume(n.active,e),n.preparing.sound){n.preparing.audio.src=F;var a=n.preparing.sound;n.preparing.sound=null,a.trigger("finish")}console.log(e.id+" initiating play()");var s=n.active;try{if(n.active.audio.play(),!i.outstandingSounds[e.id])return t(e.id+" play() succeeded, but sound has been destroyed"),void(s.audio&&s.audio.src===e.url&&(t(e.id+" being paused and unloaded"),s.audio.pause(),s.audio.src=F));console.log(e.id+" play() succeeded"),s.sound=e,e.fadeOutSeconds&&0===e.fadeOutEnd&&(e.fadeOutStart=s.audio.duration-e.fadeOutSeconds,e.fadeOutEnd=s.audio.duration),e.startPosition&&(t("updating start position"),s.audio.currentTime=e.startPosition/1e3,t("updated"));var r=!s.audio.playing();e.trigger("play"),s.pauseAfterPlay?s.audio.pause():r&&e.trigger("pause")}catch(n){t("error starting playback with sound "+e.id,n),e.trigger("finish",n)}};if(this.preparing.audio.src!==e.url)return void this._prepare(e.url,e.startPosition).then((function(){o()}));o()}else console.error("**** player.initializeAudio() *** not called before playback!")},_destroySound:function(e){e.off(),this.active&&this.active.sound===e?console.log("destroy triggered for current sound",e.id):console.log("destroy triggered for inactive sound",e.id),this.active&&this.active.audio&&this.active.audio.pause(),delete this.outstandingSounds[e.id]},flush:function(){for(var e in this.outstandingSounds)this.outstandingSounds[e].destroy()},_pauseSound:function(e){this.active&&e.url===this.active.url&&(this.active.sound===e?this.active.audio.pause():this.active.pauseAfterPlay=!0),this.fading&&this.fading.audio&&this.fading.audio.pause()},_position:function(e){return this.active&&e===this.active.sound?(e.url!==this.active.url&&t("trying to get current song position, but it is not in the active audio player"),Math.floor(1e3*this.active.audio.currentTime)):0},_duration:function(e){if(e===this.active.sound){e.url!==this.active.url&&t("trying to get current song duration, but it is not in the active audio player");var n=this.active.audio.duration;return isNaN(n)?0:Math.floor(1e3*n)}return 0},setVolume:function(e){return void 0!==e&&(this.vol=e,this.active&&this.active.sound&&this._setVolume(this.active),this.trigger("volume",e)),this.vol},getVolume:function(){return this.vol}},Object.assign(N.prototype,v);function U(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W(e){var t=e.charAt(e.length-1),n=parseInt(e,10),i=new Date;switch(t){case"Y":i.setFullYear(i.getFullYear()+n);break;case"M":i.setMonth(i.getMonth()+n);break;case"D":i.setDate(i.getDate()+n);break;case"h":i.setHours(i.getHours()+n);break;case"m":i.setMinutes(i.getMinutes()+n);break;case"s":i.setSeconds(i.getSeconds()+n);break;default:i=new Date(e)}return i}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function z(e,t){if(void 0===t&&(t=decodeURIComponent),"string"!=typeof e||!e)return null;var n=new RegExp("(?:^|; )"+(e.replace(/[.*+?^$|[\](){}\\-]/g,"\\$&")+"(?:=([^;]*))?(?:;|$)")).exec(document.cookie);return null===n?null:"function"==typeof t?t(n[1]):n[1]}function X(e,t,n,i){void 0===n&&(n=encodeURIComponent),"object"==typeof n&&null!==n&&(i=n,n=encodeURIComponent);var o=function(e){var t="";for(var n in e)if(U(e,n))if(/^expires$/i.test(n)){var i=e[n];"object"!=typeof i&&(i=W(i+="number"==typeof i?"D":"")),t+=";"+n+"="+i.toUTCString()}else/^secure$/.test(n)?e[n]&&(t+=";"+n):t+=";"+n+"="+e[n];return U(e,"path")||(t+=";path=/"),t}(i||{}),a=e+"="+("function"==typeof n?n(t):t)+o;document.cookie=a}function Y(e,t){var n={expires:-1};return t&&(n=$({},t,n)),X(e,"a",n)}var Z="https://feed.fm";function Q(){return Z}function J(e){Z=function(e,t){return"//"===e.slice(0,2)&&(e=!0===t?"https:"+e:!1===t?"http:"+e:"http"===window.location.protocol.substr(0,4)?window.location.protocol+e:"http"),e}(e)}var K,ee="undefined"==typeof document,te=null;function ne(e,n){var i=ee?te:z("cid");if(i)return e(i);fetch(Q()+"/api/v2/client",{method:"POST"}).then((function(e){return e.json()})).then((function(t){t.success?e(t.client_id):g(n,2e3,(function(t){ne(e,t)}))})).catch((function(i){if(403===i.status)try{var o=JSON.parse(i.responseText);t("error trying to get client id:",o)}catch(e){t("unknown response for client id request",e.message)}else t("unknown client id response status",i.status);g(n,2e3,(function(t){ne(e,t)}))}))}function ie(){return K||(K=new Promise((function(e){ne((function(t){var n;n=t,ee?te=n:X("cid",n,{expires:3650,path:"/"}),e(t)}))}))),K}var oe=function(e,t,n){(n=n||{}).baseUrl&&J(n.baseUrl),this.config={formats:"mp3,aac",maxBitrate:96,timeOffset:0,current:null,pendingRequest:null,pendingPlay:null},Object.assign(this,v),e&&t&&this.setCredentials(e,t)};oe.prototype.setCredentials=function(e,t){this.config.token=e,this.config.secret=t},oe.prototype.setStationId=function(e){if(this.config.stations){var t=""+e;if(""+this.config.stationId!==t){var n=this.config.stations.find((function(e){return""+e.id===t}));n&&(this.config.stationId=e,this.config.station=n,this.trigger("station-changed",e,n),this._retune())}}},oe.prototype.setFormats=function(e){this.config.formats=e,this._retune()},oe.prototype.setMaxBitrate=function(e){this.config.maxBitrate=e},oe.prototype.tune=function(){if(!this.config.token)throw new Error("no token set with setCredentials()");if(!this.config.secret)throw new Error("no secret set with setCredentials()");this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0),this._getDefaultPlacementInformation()},oe.prototype._getDefaultPlacementInformation=function(e){var n=this;if(this.config.placementId&&this.config.placement&&this.config.placement.id===this.config.placementId)return console.log("requesting next play"),void this._requestNextPlay();ie().then((function(i){t("requesting default placement information from server"),n._signedAjax(Q()+"/api/v2/placement?client_id="+i).then((function(e){return e.json()})).then(n._receiveDefaultPlacementInformation.bind(n)).catch(n._failedDefaultPlacementInformation.bind(n,e))}))},oe.prototype._receiveDefaultPlacementInformation=function(e){e&&e.success&&e.placement&&(this.config.placement=e.placement,this.config.stations=e.stations,this.config.placementId=e.placement.id,this.trigger("placement",this.config.placement),this.config.stations.length>0&&(this.config.stationId=this.config.stations[0].id,this.config.station=this.config.stations[0],this.trigger("station-changed",this.config.stationId,this.config.station)),this.trigger("stations",this.config.stations),this._requestNextPlay())},oe.prototype._failedDefaultPlacementInformation=function(e,t){var n=this;if(401===t.status)try{var i=JSON.parse(t.responseText);if(i.error&&5===i.error.code)return void this.trigger("invalid-credentials")}catch(e){}else console.warn("error from placement request",t);e=e?2*e:500,setTimeout((function(){n._getDefaultPlacementInformation(e)}),e)},oe.prototype.getActivePlacement=function(){return this.config.placement?this.config.placement:null},oe.prototype.getActivePlay=function(){return this.config.current?this.config.current.play:null},oe.prototype.isTuned=function(){return this.config.current||this.config.pendingRequest},oe.prototype.hasActivePlayStarted=function(){return this.config.current&&this.config.current.started},oe.prototype._retune=function(){this.isTuned()&&this.tune()},oe.prototype.reportPlayStarted=function(){if(!this.config.current)throw new Error("attempt to report a play started, but there is no active play");this._startPlay(this.config.current.play)},oe.prototype.reportPlayElapsed=function(e){if(!this.config.current)throw new Error("attempt to report elapsed play time, but the play hasn't started");this._signedAjax(Q()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:e}),headers:{"Content-Type":"application/json"}})},oe.prototype.reportPlayCompleted=function(){if(!this.config.current||!this.config.current.started)throw t("finish on non-active or playing song"),new Error("no active or playing song");this._signedAjax(Q()+"/api/v2/play/"+this.config.current.play.id+"/complete",{method:"POST"}).finally(this._receivePlayCompleted.bind(this))},oe.prototype._receivePlayCompleted=function(){if(this.config.pendingRequest)t("song finished, but we're still waiting for next one to return"),this._assignCurrentPlay(null,!0);else{console.log("song finished, and no outstanding request, so playing pendingPlay");var e=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(e)}},oe.prototype.reportPlayStopped=function(e){this.config.current&&this.config.current.started&&this._signedAjax(Q()+"/api/v2/play/"+this.config.current.play.id+"/elapse",{method:"POST",body:JSON.stringify({seconds:e}),headers:{"Content-Type":"application/json"}}),this.config.pendingRequest=null,this.config.pendingPlay=null,this._assignCurrentPlay(null,!0)},oe.prototype.requestSkip=function(){var e=this;if(!this.config.current)throw new Error("No song being played");if(!this.config.current.started)throw new Error("No song has been started");this.config.current.canSkip?this._signedAjax(Q()+"/api/v2/play/"+this.config.current.play.id+"/skip",{method:"POST"}).then((function(e){return e.json()})).then(this._receiveSkip.bind(this,this.config.current.play)).catch(this._failSkip.bind(this,this.config.current.play)):setTimeout((function(){e.trigger("skip-denied")}),1)},oe.prototype.requestInvalidate=function(){if(!this.config.current)throw new Error("No active song to invalidate!");this._sendInvalidate(this.config.current.play)},oe.prototype._sendInvalidate=function(e,t){this._signedAjax(Q()+"/api/v2/play/"+e.id+"/invalidate",{method:"POST"}).then((function(e){return e.json()})).then(this._receiveInvalidate.bind(this,e)).catch(this._failInvalidate.bind(this,t,e))},oe.prototype._failInvalidate=function(e,n,i){var o=this;(e=e?2*e:200)<3e3?setTimeout((function(){o._sendInvalidate(n)}),e):t("gave up trying to invalidate play",i)},oe.prototype._receiveInvalidate=function(e,n){if(t("invalidate response"),this.config.current&&this.config.current.play===e)if(n.success)if(this.config.pendingPlay){t("invalidating to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else t("invalidating current song"),this._assignCurrentPlay(null,!0),this.config.pendingRequest||(t("queueing up new song"),this._requestNextPlay());else t("failed invalidate! - technically this is impossible")},oe.prototype._failSkip=function(e){this.config.current&&this.config.current.play===e&&this.trigger("skip-denied")},oe.prototype._receiveSkip=function(e,n){if(this.config.current&&this.config.current.play===e){if(!n.success)return t("failed skip!"),void this.trigger("skip-denied");if(this.config.pendingPlay){console.log("skipping to song already queued up");var i=this.config.pendingPlay;this.config.pendingPlay=null,this._assignCurrentPlay(i)}else this.config.pendingRequest?(console.log("skipping to what is queued up"),this._assignCurrentPlay(null,!0)):(console.log("skipping to what is queued up"),this._assignCurrentPlay(null))}},oe.prototype._startPlay=function(e){this.config.current.retryCount>2?this._receiveStartPlay(e,{success:!0,can_skip:!0}):(t("telling server we're starting the play",e),this._signedAjax(Q()+"/api/v2/play/"+e.id+"/start",{method:"POST"}).then((function(e){return e.json()})).then(this._receiveStartPlay.bind(this,e)).catch(this._failStartPlay.bind(this,e)))},oe.prototype._receiveStartPlay=function(e,n){n.success?this.config.current&&this.config.current.play===e?(this.config.current.canSkip=n.can_skip,this.config.current.started=!0,this._requestNextPlay(),this.trigger("play-started",e)):t("received start play, but not waiting any more"):t("received failed start success")},oe.prototype._failStartPlay=function(e,n){var i=this;if(t("start failed",n),this.config.current&&this.config.current.play===e){if(403===n.status)try{var o=JSON.parse(n.responseText);if(o.error&&20===o.error.code)return this._receiveStartPlay(e,{success:!0,can_skip:!0})}catch(e){t("unable to parse start play response",e.message)}t("request failed - trying again in 1 second",n),this.config.current.retryCount++,setTimeout((function(){i._startPlay(e)}))}else t("startPlay failed, but we don't care any more")},oe.prototype._assignCurrentPlay=function(e,t){if(this.config.current){var n=this.config.current.play;this.config.current=null,this.trigger("play-completed",n)}null===e?t?console.log("nothing to play... waiting"):(console.log("nothing to play from the current station"),this.trigger("plays-exhausted")):(this.config.current={play:e,canSkip:!1,started:!1,retryCount:0},console.log("activated new song"),this.trigger("play-active",e))},oe.prototype._requestNextPlay=function(e){var t=this;ie().then((function(n){if(console.log(t.config.pendingRequest),t.config.pendingRequest){if(e){if(e>6e4)return console.log("giving up on retrieving next play"),t.config.pendingRequest=null,void(null===t.config.current&&t._assignCurrentPlay(null));console.log("retrying pending request"),t.config.pendingRequest.retryCount++;var i=t.config.pendingRequest.ajax;return void t._signedAjax(t.config.pendingRequest.url,i).then((function(e){return e.json()})).then(t._receiveNextPlay.bind(t,i)).catch(t._failedNextPlay.bind(t,e,i))}console.log("already waiting for a request to finish")}else{var o={formats:t.config.formats,client_id:n,max_bitrate:t.config.maxBitrate,secure:!0};t.config.placementId&&(o.placement_id=t.config.placementId),t.config.stationId&&(o.station_id=t.config.stationId);var a={method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}};t.config.pendingRequest={url:Q()+"/api/v2/play",ajax:a,retryCount:0},console.log("requesting new play from server",a),t._signedAjax(Q()+"/api/v2/play",a).then((function(e){return e.json()})).then(t._receiveNextPlay.bind(t,a)).catch(t._failedNextPlay.bind(t,e,a))}}))},oe.prototype._receiveNextPlay=function(e,t){console.log(e,t,this.config.pendingRequest&&this.config.pendingRequest.ajax===e),this.config.pendingRequest&&this.config.pendingRequest.ajax===e?(this.config.pendingRequest=null,t.success?(this.trigger("prepare-sound",t.play.audio_file.url),this.config.current?(console.log("received play, but we're already playing, so queueing up",t.play),this.config.pendingPlay=t.play):(console.log("received play and no current song, making active now",t.play),this._assignCurrentPlay(t.play))):t.error&&9===t.error.code?this.config.current?(console.log("ran out of music to play, but we're already playing"),this.config.pendingPlay=null):(console.log("ran out of music, and nothing playing now"),this.trigger("plays-exhausted")):console.log("unsuccessful response",t)):console.log("nextPlay succeeded, but we don't care")},oe.prototype._failedNextPlay=function(e,n,i){var o=this;if(t("next play failed",i),this.config.pendingRequest&&this.config.pendingRequest.ajax===n){if(403===i.status)try{var a=JSON.parse(i.responseText);if(a.error&&19===a.error.code)return this.trigger("music-unavailable",a.error.message),void this.trigger("not-in-us",a.error.message)}catch(e){t("problem parsing 403 response",e.message)}e=Math.min(e?2*e:500,2e3),t("request failed - trying again after "+e+"ms"),setTimeout((function(){o._requestNextPlay(e)}),e)}else t("nextPlay failed, but we don't care")},oe.prototype.maybeCanSkip=function(){return this.config.current&&this.config.current.started&&this.config.current.canSkip},oe.prototype.likePlay=function(e){this._signedAjax(Q()+"/api/v2/play/"+e+"/like",{method:"POST"}),this.config.current&&this.config.current.play.id===e&&(this.config.current.play.liked=!0)},oe.prototype.unlikePlay=function(e){this._signedAjax(Q()+"/api/v2/play/"+e+"/like",{method:"DELETE"}),this.config.current&&this.config.current.play.id===e&&delete this.config.current.play.liked},oe.prototype.dislikePlay=function(e){this._signedAjax(Q()+"/api/v2/play/"+e+"/dislike",{method:"POST"}),this.config.current&&this.config.current.play.id===e&&(this.config.current.play.liked=!1)};function ae(){try{return"localStorage"in window&&null!==window.localStorage&&(window.localStorage["feed-test"]=!0)}catch(e){return!1}}oe.prototype._getStoredCid=function(){return z("cid")},oe.prototype._setStoredCid=function(e){X("cid",e,{expires:3650,path:"/"})},oe.prototype._deleteStoredCid=function(){Y("cid")},oe.prototype._sign=function(e){var t;if(e||(e={}),t="Basic "+btoa(this.config.token+":"+this.config.secret),e.headers?e.headers.Authorization=t:e.headers={Authorization:t},e.headers["X-Feed-SDK"]="1.99.31 js",this.extraHeaders)for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&(e.headers[n]=this.extraHeaders[n]);return e},oe.prototype._signedAjax=function(e,t){return this._ajax(e,this._sign(t))},oe.prototype._ajax=function(e,t){return fetch(e,t)},oe.prototype._submitLogHistory=function(){var e=t.history;return t.history=[],this._signedAjax(Q()+"/api/v2/session/event",{method:"POST",body:JSON.stringify({event:"playerHistory",parameters:e}),headers:{"Content-Type":"application/json"}})};var se=function(e,n,i){var o=this;i=i||{},this.state={paused:!0,simulcast:i.simulcast},i.debug&&t.enable(),this.trimming=!!i.trimming,this.normalizeVolume=!("normalizeVolume"in i)||i.normalizeVolume,this.secondsOfCrossfade=i.secondsOfCrossfade||0,this.crossfadeIn=!!i.crossfadeIn,this._stationsPromise=new Promise((function(e,t){o._stationsResolve=e,o._stationsReject=t})),Object.assign(this,v);var a=this.session=new oe(e,n,i);this.session.on("play-active",this._onPlayActive,this),this.session.on("play-started",this._onPlayStarted,this),this.session.on("play-completed",this._onPlayCompleted,this),this.session.on("plays-exhausted",this._onPlaysExhausted,this),this.session.on("prepare-sound",this._onPrepareSound,this),this.session.on("placement",this._onPlacement,this),this.session.on("stations",this._onStations,this),this.session.on("station-changed",this._onStationChanged,this);for(var s=this,r=function(){var e=d[u];o.session.on(e,(function(){s.trigger.apply(s,[e].concat(Array.prototype.slice.call(arguments,0)))}))},u=0,d=["music-unavailable","not-in-us","invalid-credentials","skip-denied"];u<d.length;u++)r();i.debug&&this.session.on("play-active",(function(){s.trigger.apply(s,["play-active"].concat(Array.prototype.slice.call(arguments,0)))}));var l=this.speaker=i.speaker||new C;if(i.brokenWebkitFormats&&C.brokenWebkit){var c=i.brokenWebkitFormats.split(","),p=l.getSupportedFormats().split(","),h=_(c,p),f=h.join(",");t("input format list is",c,p),t("final support list is",f),0===h.length&&(f=l.getSupportedFormats()),a.setFormats(f)}else if(i.formats){var g=i.formats.split(","),y=l.getSupportedFormats().split(","),m=_(g,y),b=m.join(",");0===m.length&&(b=l.getSupportedFormats()),t("input format list is",g,y),t("final support list is",b),a.setFormats(b)}else a.setFormats(l.getSupportedFormats());this.setMuted(this.isMuted())};se.prototype.initializeAudio=function(){return console.log("INTIALIZE AUDIO"),this.speaker.initializeAudio()},se.prototype._onPlacement=function(e){this._placement=e,e.options&&e.options.crossfade_seconds&&(this.secondsOfCrossfade=e.options.crossfade_seconds),this.trigger("placement",e)},se.prototype._onStations=function(e){this._stations=e,this._stationsResolve(e),this.trigger("stations",e)},se.prototype._onStationChanged=function(e,t){this._station=t,t.options&&"crossfade_seconds"in t.options?this.secondsOfCrossfade=t.options.crossfade_seconds:this._placement.options&&"crossfade_seconds"in this._placement.options&&(this.secondsOfCrossfade=this._placement.options.crossfade_seconds),this.trigger("station-changed",e,t)},se.prototype.setStationId=function(e){t("SET STATION ID",e),this.session.setStationId(e)},se.prototype._onPlayActive=function(e){var t={play:this._onSoundPlay.bind(this,e.id),pause:this._onSoundPause.bind(this,e.id),finish:this._onSoundFinish.bind(this,e.id),elapse:this._onSoundElapse.bind(this,e.id)};this.normalizeVolume&&(t.gain=(e.audio_file.replaygain_track_gain||0)+(e.station.pre_gain||0)),this.trimming&&e.audio_file.extra&&e.audio_file.extra.trim_start&&(t.startPosition=1e3*e.audio_file.extra.trim_start),this.trimming&&e.audio_file.extra&&e.audio_file.extra.trim_end&&e.audio_file.duration_in_seconds&&(t.endPosition=1e3*(e.audio_file.duration_in_seconds-e.audio_file.extra.trim_end)),this.secondsOfCrossfade&&(this.crossfadeIn&&(t.fadeInSeconds=this.secondsOfCrossfade),t.fadeOutSeconds=this.secondsOfCrossfade);var n=this.speaker.create(e.audio_file.url,t);(this.state.activePlay={id:e.id,sound:n,startReportedToServer:!1,soundCompleted:!1,playStarted:!1,previousPosition:0},this.state.paused)||this.state.activePlay.sound.play()},se.prototype._onSoundPlay=function(e){if(this.state.activePlay&&this.state.activePlay.id===e){if(this.state.paused=!1,this.state.activePlay.playStarted=!0,!this.state.activePlay.startReportedToServer)return this.session.reportPlayStarted();this.trigger("play-resumed",this.session.getActivePlay())}else t("received sound play, but active play does not match",this.state.activePlay,e)},se.prototype.getActivePlay=function(){return this.session.getActivePlay()},se.prototype.hasActivePlayStarted=function(){return this.session.hasActivePlayStarted()},se.prototype.getActivePlacement=function(){return this.session.getActivePlacement()},se.prototype._onSoundPause=function(e){this.state.activePlay&&this.state.activePlay.id===e?(this.state.paused=!0,console.log("triggering play paused"),this.trigger("play-paused",this.session.getActivePlay())):console.log("received sound pause, but active play does not match",this.state.activePlay,e)},se.prototype._onSoundFinish=function(e,n){if(this.state.activePlay&&this.state.activePlay.id===e){if(this.state.activePlay.soundCompleted=!0,n&&(this.state.activePlay.soundCompletedWithError=!0,"NotAllowedError"===n.name))return console.error('Feed.fm: first call to "initializeAudio()" or "play()" must be made in user-initiated event handler'),void this.stop();this.state.activePlay.playStarted?this.state.activePlay.startReportedToServer&&(n?(t("song completed with error - marking as invalid"),this.session.requestInvalidate()):this.session.reportPlayCompleted()):this.session.requestInvalidate()}else console.log("received sound finish, but active play does not match",this.state.activePlay,e)},se.prototype._onSoundElapse=function(e){if(this.state.activePlay&&this.state.activePlay.id===e){var t=this.state.activePlay.sound.position(),n=Math.floor(this.state.activePlay.previousPosition/3e4),i=Math.floor(t/3e4);this.state.activePlay.previousPosition=t,i!==n&&this.session.reportPlayElapsed(Math.floor(t/1e3))}else console.log("received sound elapse, but active play does not match",this.state.activePlay,e)},se.prototype._onPlayStarted=function(e){var n=this.session;this.state.activePlay&&this.state.activePlay.id===e.id?(this.state.activePlay.startReportedToServer=!0,this.state.activePlay.soundCompleted&&(t("sound completed before we finished reporting start",this.state.activePlay),this.state.activePlay.soundCompletedWithError?setTimeout((function(){return n.requestInvalidate()}),1):setTimeout((function(){return n.reportPlayCompleted()}),1)),this.updateSimulcast(),this.trigger("play-started",e)):t("received play started, but it does not match active play",e,this.state.activePlay)},se.prototype._onPlayCompleted=function(e){if(this.state.activePlay&&this.state.activePlay.id===e.id){this.state.activePlay.sound.destroy();var t=this.state.activePlay.playStarted;delete this.state.activePlay,t&&this.trigger("play-completed",e)}else console.log("received play completed, but it does not match active play",e,this.state.activePlay)},se.prototype._onPlaysExhausted=function(){this.state.paused=!1,this.updateSimulcast(),this.trigger("plays-exhausted")},se.prototype._onPrepareSound=function(e){t("preparing",e),this.speaker.prepare(e)},se.prototype.isPaused=function(){return this.session.isTuned()&&this.state.paused},se.prototype.getStationInformation=function(e){return this.session.getStationInformation(e)},se.prototype.tune=function(){t("TUNE"),this.session.isTuned()||this.session.tune()},se.prototype.play=function(){var e=this;t("PLAY");var n=this.session,i=this.state;Promise.resolve(this.speaker.initializeAudio()).then((function(){if(!n.isTuned())return i.paused=!1,n.tune();n.getActivePlay()&&i.activePlay&&i.paused&&(i.activePlay.playStarted?i.activePlay.sound.resume():i.activePlay.sound.play()),i.paused=!1,e.updateSimulcast()}))},se.prototype.pause=function(){if(t("PAUSE"),console.log(this.session.hasActivePlayStarted(),this.state.activePlay,this.state.paused),this.session.hasActivePlayStarted()&&this.state.activePlay&&!this.state.paused){console.log("Calling pause on howl",this.state.activePlay.sound);var e=this.state.activePlay.sound.pause();console.log(e),this.state.paused=!0,this.updateSimulcast()}},se.prototype.like=function(){t("LIKE"),this.session.hasActivePlayStarted()&&(this.session.likePlay(this.state.activePlay.id),this.trigger("play-liked"))},se.prototype.unlike=function(){t("UNLIKE"),this.session.hasActivePlayStarted()&&(this.session.unlikePlay(this.state.activePlay.id),this.trigger("play-unliked"))},se.prototype.dislike=function(){t("DISLIKE"),this.session.hasActivePlayStarted()&&(this.session.dislikePlay(this.state.activePlay.id),this.trigger("play-disliked"),this.state.paused=!1,this.skip())},se.prototype.skip=function(){t("SKIP"),this.session.hasActivePlayStarted()&&(this.state.paused=!1,this.session.requestSkip())},se.prototype.stop=function(){t("STOP"),this.state.paused=!0;var e=this.state.activePlay;if(e&&e.sound){if(t("stopping active play",e),e.startReportedToServer){var n=e.sound.position();this.session.reportPlayStopped(Math.floor(n/1e3))}Promise.resolve(e.sound.pause()).then((function(){e.sound.destroy()}))}else t("no active play");delete this.state.activePlay,this.speaker.flush(),this.trigger("play-stopped"),this.updateSimulcast()},se.prototype.destroy=function(){this.session=null,this.state.activePlay&&this.state.activePlay.sound&&this.state.activePlay.sound.destroy()},se.prototype.getCurrentState=function(){return this.state.suspended?"suspended":this.session.hasActivePlayStarted()?this.state.paused?"paused":"playing":"idle"},se.prototype.getPosition=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.position():0},se.prototype.getDuration=function(){return this.state.activePlay&&this.state.activePlay.sound?this.state.activePlay.sound.duration():0},se.prototype.maybeCanSkip=function(){return!!this.session.maybeCanSkip()};se.prototype.isMuted=function(){return!(!ae()||!("muted"in localStorage))&&"true"===localStorage.muted},se.prototype.setMuted=function(e){e?(this.speaker.setVolume(0),ae()&&(localStorage.muted=!0),this.trigger("muted")):(this.speaker.setVolume(100),ae()&&(localStorage.muted=!1),this.trigger("unmuted"))},se.prototype.getVolume=function(){return this.speaker.getVolume()},se.prototype.setVolume=function(e){this.speaker.setVolume(e)},se.prototype.getStations=function(){return this._stationsPromise},se.prototype.updateSimulcast=function(){var e=this;if(this.state.simulcast){var t=this.getCurrentState();"suspended"===t&&(t="idle"),ie().then((function(n){e.session._signedAjax(Q()+"/api/v2/simulcast/".concat(e.state.simulcast,"/in-progress"),{method:"POST",body:JSON.stringify({state:t,client_id:n}),headers:{"Content-Type":"application/json"}})}))}};var re=function(){function e(t){o(this,e),Object.assign(this,v),this._uuid=t,this._state="idle"}return s(e,[{key:"listen",value:function(){var e=this;this._timeout&&(clearTimeout(this._timeout),delete this._timeout),ie().then((function(t){e.onTimeout(t)}))}},{key:"stop",value:function(){this._timeout&&(clearTimeout(this._timeout),delete this._timeout);var e=this._state;if(this._state="idle",delete this._activePlay,"idle"!==e)try{this.trigger("state-changed",this._state,e)}catch(e){}}},{key:"onTimeout",value:function(e){var t=this;fetch(Q()+"/api/v2/simulcast/".concat(this._uuid,"/listen"),{method:"POST",body:JSON.stringify({client_id:e}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(n){var i=5e3;if(n.success){var o="idle"===n.state&&"idle"!==t._state,a=t._activePlay,s=t._state,r=t._state=n.state;if("idle"===r?delete t._activePlay:t._activePlay=n.play,s!==r)try{t.trigger("state-changed",r,s)}catch(e){}if("idle"===r){if(o)try{t.trigger("music-stopped")}catch(e){}}else{if(!a||a.id!==t._activePlay.id)try{t.trigger("play-started",t._activePlay)}catch(e){}n.seconds_since_start>20&&n.play.duration_in_seconds-n.seconds_since_start>20&&(i=15e3)}}else if(n.error&&19===n.error.code)return t._state="music-unavailable",void t.trigger("music-unavailable");t._timeout=setTimeout((function(){t.onTimeout(e)}),i)})).catch((function(n){if(403===n.status)try{var i=JSON.parse(n.responseText);if(i.error&&19===i.error.code){try{t._state="music-unavailable",t.trigger("music-unavailable")}catch(e){}return}console.log("unexpected error:",i)}catch(e){console.log("bad response",e.message)}else console.log("odd response",n);t._timeout=setTimeout((function(){t.onTimeout(e)}),15e3)}))}},{key:"getCurrentState",value:function(){return this._state}},{key:"getCurrentPlay",value:function(){return this._activePlay}}]),e}();window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)});var ue=function(e,t){var n=this;this.alertId=null,this.durationId=null,this.startedPlayback=!1,this.$el=e instanceof Element?e:document.getElementById(e),this.player=t,this.player.on("placement",this._onPlacement,this),this.player.on("play-started",this._onPlayStarted,this),this.player.on("play-paused",this._onPlayPaused,this),this.player.on("play-resumed",this._onPlayResumed,this),this.player.on("play-completed",this._onPlayCompleted,this),this.player.on("play-stopped",this._onPlayStopped,this),this.player.on("play-liked",this._onPlayLiked,this),this.player.on("play-unliked",this._onPlayUnliked,this),this.player.on("play-disliked",this._onPlayDisliked,this),this.player.on("plays-exhausted",this._onPlaysExhausted,this),this.player.on("skip-denied",this._onSkipDenied,this),this.player.on("suspend",this._onSuspend,this),this._enableButtonsBasedOnState(),this.displayText=this.originalDisplayText=this.$el.querySelector(".status").innerHTML,this.renderStatus(),this.$el.querySelectorAll(".status").forEach((function(e){e.addEventListener("click",n._onStatusClick.bind(n))})),this.$el.querySelectorAll(".play-button, .start-button, .resume-button").forEach((function(e){e.addEventListener("click",n._onPlayButtonClick.bind(n))})),this.$el.querySelectorAll(".pause-button").forEach((function(e){e.addEventListener("click",n._onPauseButtonClick.bind(n))})),this.$el.querySelectorAll(".skip-button").forEach((function(e){e.addEventListener("click",n._onSkipButtonClick.bind(n))})),this.$el.querySelectorAll(".like-button").forEach((function(e){e.addEventListener("click",n._onLikeButtonClick.bind(n))})),this.$el.querySelectorAll(".dislike-button").forEach((function(e){e.addEventListener("click",n._onDislikeButtonClick.bind(n))}))};function de(e){var t=Math.floor(e/1e3),n=t%60;return n<10&&(n="0"+n),Math.floor(t/60)+":"+n}ue.prototype._onStatusClick=function(){"playing"===this.player.getCurrentState()?this._onPauseButtonClick():this._onPlayButtonClick()},ue.prototype._onPlayButtonClick=function(){this.player.initializeAudio(),this.player.play()},ue.prototype._onPauseButtonClick=function(){this.player.pause()},ue.prototype._onSkipButtonClick=function(){this.player.skip()},ue.prototype._onLikeButtonClick=function(e){t("like button clicked!",e.target,this),e.target.classList.contains("liked")?this.player.unlike():this.player.like()},ue.prototype._onDislikeButtonClick=function(){this.player.dislike()},ue.prototype.$=function(e){return this.$el.find(e)},ue.prototype._onPlacement=function(e){this.originalDisplayText||(this.originalDisplayText=this.formatPlacement(e),this.renderStatus(this.originalDisplayText))},ue.prototype.formatPlacement=function(){return"Tune in!"},ue.prototype._onPlayStarted=function(e){this.startedPlayback=!0,this.renderStatus(this.formatPlay(e)),this._enableButtonsBasedOnState(),this._setLikeStatus(e.liked),this._enablePositionTracker()},ue.prototype._enablePositionTracker=function(){var e=this;this.durationId||(this.durationId=window.setInterval((function(){e.renderPosition(e.player.getPosition(),e.player.getDuration())}),500))},ue.prototype._setLikeStatus=function(e){var t=this.$el.querySelectorAll(".like-button"),n=this.$el.querySelectorAll(".dislike-button");!0===e?(t.forEach((function(e){e.classList.add("liked")})),n.forEach((function(e){e.classList.remove("disliked")}))):!1===e?(t.forEach((function(e){e.classList.remove("liked")})),n.forEach((function(e){e.classList.add("disliked")}))):(t.forEach((function(e){e.classList.remove("liked")})),n.forEach((function(e){e.classList.remove("disliked")})))},ue.prototype._disablePositionTracker=function(){this.durationId&&(window.clearInterval(this.durationId),this.durationId=null)},ue.prototype._onPlayResumed=function(){this._enablePositionTracker(),this._enableButtonsBasedOnState()},ue.prototype._onPlayPaused=function(){this._disablePositionTracker(),this._enableButtonsBasedOnState()},ue.prototype._onPlayCompleted=function(){this.renderPosition(0,0),this._enableButtonsBasedOnState()},ue.prototype._onPlayStopped=function(){this.renderStatus(this.originalDisplayText),this.renderPosition(0,0),this._enableButtonsBasedOnState()},ue.prototype._onPlaysExhausted=function(){this.renderStatus(this.originalDisplayText),this.renderAlert("There is no more music to play in this station!"),this._enableButtonsBasedOnState()},ue.prototype._onPlayLiked=function(){this._setLikeStatus(!0)},ue.prototype._onPlayDisliked=function(){this._setLikeStatus(!1)},ue.prototype._onPlayUnliked=function(){this._setLikeStatus()},ue.prototype._onSkipDenied=function(){this.renderAlert("Sorry you've temporarily run out of skips!")},ue.prototype.formatPlay=function(e){return"<span class='track'>"+e.audio_file.track.title+"</span> by <span class='artist'>"+e.audio_file.artist.name+"</span> on <span class='release'>"+e.audio_file.release.title+"</span>"},ue.prototype.renderStatus=function(e){var t=this;void 0!==e&&(this.displayText=e),this.alertId||this.$el.querySelectorAll(".status").forEach((function(e){e.innerHTML=t.displayText,e.classList.remove("alert")}))},ue.prototype.renderPosition=function(e,t){if(this.$el.querySelectorAll(".elapsed").forEach((function(t){t.innerHTML=de(e)})),this.$el.querySelectorAll(".duration").forEach((function(e){e.innerHTML=de(t)})),0===t)this.$el.querySelectorAll(".progress").forEach((function(e){e.style.width="0"}));else{var n=Math.round((e+1e3)/t*100);n=n>100?100:n,this.$el.querySelectorAll(".progress").forEach((function(e){e.style.width=n+"%"}))}},ue.prototype.renderAlert=function(e){this.alertId&&window.clearTimeout(this.alertId),this.$el.querySelectorAll(".status").forEach((function(t){t.innerHTML=e,t.classList.add("alert")}));var t=this;this.alertId=window.setTimeout((function(){t.alertId=null,t.renderStatus()}),3e3)},ue.prototype._onSuspend=function(){this._enableButtonsBasedOnState()},ue.prototype._enableButtonsBasedOnState=function(){var e,t,n=this.player.getCurrentState();switch(n){case"playing":e=[".pause-button",".like-button",".dislike-button"],t=[".play-button",".start-button",".resume-button"],this.player.maybeCanSkip()?e.push(".skip-button"):t.push(".skip-button");break;case"paused":e=[".play-button",".resume-button",".like-button",".dislike-button"],t=[".pause-button",".start-button"],this.player.maybeCanSkip()?e.push(".skip-button"):t.push(".skip-button");break;case"suspended":e=[],t=[".play-button",".resume-button",".like-button",".dislike-button",".pause-button",".start-button",".skip-button"];break;default:e=[".play-button",".start-button"],t=[".resume-button",".pause-button",".like-button",".dislike-button",".skip-button"]}var i,o=l(t);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.$el.querySelectorAll(a).forEach((function(e){e.classList.remove("button-enabled"),e.classList.add("button-disabled"),e.disabled=!0}))}}catch(e){o.e(e)}finally{o.f()}var s,r=l(e);try{for(r.s();!(s=r.n()).done;){var u=s.value;this.$el.querySelectorAll(u).forEach((function(e){e.classList.remove("button-disabled"),e.classList.add("button-enabled"),e.disabled=!1}))}}catch(e){r.e(e)}finally{r.f()}var d=this.$el.classList;d.remove("state-playing"),d.remove("state-paused"),d.remove("state-idle"),d.remove("state-suspended"),d.add("state-"+n)};var le=function(){function e(t){o(this,e),Object.assign(this,v),this._speaker=new C,this._uuid=t,this._state="idle",this._activePlay=null,this._activeSound=null,this._metadataTimeout=null,this._tryingToPlay=!1,this._retries=0}return s(e,[{key:"initializeAudio",value:function(){t("INTIALIZE AUDIO"),this._speaker.initializeAudio()}},{key:"connect",value:function(){if(t("CONNECT to ".concat(this._uuid)),this._tryingToPlay)t("ignoring pointless connect to ".concat(this._uuid));else if("idle"===this._state){this._tryingToPlay=!0,this._speaker.initializeAudio(),this._setState("connecting");var e=new URL(Q());this._streamUrl="https://cast."+e.hostname+"/"+this._uuid,this._requestStream()}else t("ignoring connect() since we're already connected")}},{key:"_onSoundPlay",value:function(){var e=this;t("sound play!"),this._retries=0,this._lastElapsedAt=Date.now(),"connecting"===this._state?(this._setState("connected"),fetch(this._streamUrl+"/play?elapsed="+this._elapsed).then((function(e){return e.json()})).then((function(t){t.success?(e._activePlay=t.play,e.trigger("play-started",e._activePlay),e._metadataTimeout=setTimeout((function(){e._onMetadataTimeout()}),1e4)):e._metadataTimeout=setTimeout((function(){e._onSoundPlay()}),3e3)})).catch((function(){e._metadataTimeout=setTimeout((function(){e._onSoundPlay()}),2e3)}))):this._metadataTimeout||(this._metadataTimeout=setTimeout((function(){e._onMetadataTimeout()}),1e4))}},{key:"_onSoundElapse",value:function(){if(this._activeSound){var e=this._elapsed;(this._elapsed=this._activeSound.position())-e>0&&(this._lastElapsedAt=Date.now())}}},{key:"_requestStream",value:function(){t("requesting stream"),this._tryingToPlay&&(this._activeSound&&(this._activeSound.destroy(),this._activeSound=null),this._metadataTimeout&&(clearTimeout(this._metadataTimeout),this._metadataTimeout=null),this._activePlay=null,this._activeSound=this._speaker.create(this._streamUrl,{play:this._onSoundPlay.bind(this),finish:this._onSoundFinish.bind(this),elapse:this._onSoundElapse.bind(this)}),this._activeSound.play(),this._elapsed=0,this._lastElapsedAt=Date.now())}},{key:"_onMetadataTimeout",value:function(){var e=this;fetch(this._streamUrl+"/play?elapsed="+this._elapsed).then((function(e){return e.json()})).then((function(n){n.success&&(null===n.play&&null!==e._activePlay||null!==n.play&&null===e._activePlay||null!==n.play&&null!==e._activePlay&&n.play.audio_file.id!==e._activePlay.audio_file.id)&&(e._activePlay=n.play,t("current play updated",e._activePlay),e.trigger("play-started",e._activePlay)),e._metadataTimeout=setTimeout((function(){e._onMetadataTimeout()}),1e4)})).catch((function(){e._metadataTimeout=setTimeout((function(){e._onMetadataTimeout()}),1e4)})),Date.now()-this._lastElapsedAt>4e3&&this._requestStream()}},{key:"_onSoundFinish",value:function(e){var n=this;t("sound finished",this.toObject()),"connecting"===this._state&&e?(this._tryingToPlay=!1,this._setState("music-unavailable"),this.trigger("music-unavailable")):(t("reconnecting after stream ended",e),this._activeSound&&(this._activeSound.destroy(),this._activeSound=null),this._metadataTimeout&&(clearTimeout(this._metadataTimeout),this._metadataTimeout=null),this._activePlay=null,this._retries+=1,setTimeout((function(){n._tryingToPlay&&n._requestStream()}),Math.pow(2,this._retries))),this._logEvents()}},{key:"disconnect",value:function(){t("DISCONNECT",this.toObject()),this._tryingToPlay&&(this._tryingToPlay=!1,this._activePlay=null,this._elapsed=0,this._metadataTimeout&&(clearTimeout(this._metadataTimeout),this._metadataTimeout=null),this._activeSound&&(this._activeSound.destroy(),this._activeSound=null),this._setState("idle"),this._logEvents())}},{key:"getVolume",value:function(){return this._speaker.getVolume()}},{key:"setVolume",value:function(e){this._speaker.setVolume(e)}},{key:"_setState",value:function(e){this._state!==e&&(t("state transition ".concat(this._state," -> ").concat(e)),this._state=e,this.trigger("state-changed",this._state))}},{key:"getCurrentState",value:function(){return this._state}},{key:"getCurrentPlay",value:function(){return this._activePlay}},{key:"_logEvents",value:function(){var e=t.reset();return fetch(Q()+"/api/v2/session/event",{method:"POST",body:JSON.stringify({event:"playerHistory",parameters:e}),headers:{"Content-Type":"application/json","X-Feed-SDK":"1.99.31 js"}})}},{key:"toObject",value:function(){return{state:this._state,activePlay:this._activePlay,uuid:this._uuid,metadataTimeoutIsNull:null===this._metadataTimeout,tryingToPlay:this._tryingToPlay,elapsed:this._elapsed,retries:this._retries}}},{key:"toString",value:function(){return JSON.stringify(this.toString())}}]),e}();return{Speaker:C,AudioContextSpeaker:N,Session:oe,Player:se,Listener:re,PlayerView:ue,SimulcastPlayer:le,log:t,version:"1.99.31",resetClientId:function(){ee?te=null:Y("cid"),K=null},getClientId:ie,setBaseUrl:J}}();
